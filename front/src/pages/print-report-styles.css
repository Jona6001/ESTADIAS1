/* Estilos optimizados para impresión de reportes de ventas */

@media print {
  /* Ocultar todo excepto el bloque activo para impresión */
  body * {
    visibility: hidden !important;
  }
  .print-active, .print-active * {
    visibility: visible !important;
  }
  
  /* Mostrar SOLO el contenido de impresión */
  .print-active {
    display: block !important;
    position: static !important;
  }

  /* Neutralizar posicionamiento del modal para evitar superposiciones */
  .modal, .modal-overlay, .modal-content {
    position: static !important;
    inset: auto !important;
    transform: none !important;
    box-shadow: none !important;
    background: transparent !important;
    margin: 0 !important;
    padding: 0 !important;
    width: auto !important;
    max-width: none !important;
    height: auto !important;
    max-height: none !important;
    overflow: visible !important;
  }
  
  /* Ocultar específicamente los filtros */
  .no-print,
  .users-table-filter-row,
  .modal-close-row,
  .modal-btn-row,
  nav,
  .top-actions,
  button,
  .nav-container,
  .main-navbar,
  .cotizaciones-section:not(.print-content *) {
    display: none !important;
    visibility: hidden !important;
  }
  
  /* Resetear body y html para impresión */
  html, body {
    margin: 0 !important;
    padding: 0 !important;
    width: 100% !important;
    height: auto !important;
    overflow: visible !important;
    background: white !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
  }
  
  /* Configuración de página optimizada */
  @page {
    size: A4 landscape;
    margin: 6mm 4mm;
  }
  
  /* Contenedor principal para impresión */
  .print-active {
    display: block !important;
    width: 100% !important;
    max-width: 100% !important;
    height: auto !important;
    margin: 0 !important;
    padding: 0 !important;
    position: static !important;
    background: white !important;
    font-family: Arial, sans-serif !important;
    font-size: 8pt !important;
    line-height: 1.1 !important;
    color: #000 !important;
  }
  
  /* Título del reporte compacto */
  .print-title {
    font-size: 13pt !important;
    font-weight: bold !important;
    color: #a30015 !important;
    text-align: center !important;
    margin: 0 0 2mm 0 !important;
    padding: 0 !important;
  }
  
  .print-date {
    font-size: 7pt !important;
    color: #333 !important;
    text-align: center !important;
    margin: 0 0 3mm 0 !important;
    padding: 0 !important;
  }
  
  /* Filtros aplicados muy compactos */
  .filtros-aplicados {
    font-size: 6.5pt !important;
    color: #666 !important;
    margin: 0 0 2mm 0 !important;
    padding: 1mm !important;
    border: 0.5pt solid #ddd !important;
    background: #f9f9f9 !important;
    page-break-inside: avoid !important;
  }
  
  /* Métricas ultra compactas en una fila */
  .metricas-print {
    display: table !important;
    width: 100% !important;
    margin: 0 0 2mm 0 !important;
    border-collapse: collapse !important;
    page-break-inside: avoid !important;
  }
  
  .metrica-item {
    display: table-cell !important;
    text-align: center !important;
    padding: 1mm !important;
    border: 0.5pt solid #ddd !important;
    background: #f8f9fa !important;
    width: 25% !important;
  }
  
  .metrica-valor {
    font-weight: bold !important;
    font-size: 8pt !important;
    color: #a30015 !important;
    display: block !important;
  }
  
  .metrica-label {
    font-size: 5.5pt !important;
    color: #666 !important;
    display: block !important;
  }
  
  /* Tabla principal optimizada para landscape */
  .ventas-table {
    width: 100% !important;
    border-collapse: collapse !important;
    font-size: 6pt !important;
    margin: 0 !important;
    table-layout: fixed !important;
  }
  .ventas-table thead {display: table-header-group !important;}
  .ventas-table tfoot {display: table-footer-group !important;}
  
  .ventas-table th {
    background: #a30015 !important;
    color: white !important;
    padding: 1mm 0.5mm !important;
    font-size: 6.5pt !important;
    font-weight: bold !important;
    border: 0.5pt solid #666 !important;
    text-align: center !important;
    white-space: nowrap !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
  }
  
  .ventas-table td {
    padding: 0.8mm 0.5mm !important;
    border: 0.5pt solid #ccc !important;
    font-size: 5.5pt !important;
    text-align: center !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
  
  /* Columnas específicas más compactas */
  .ventas-table th:nth-child(1),
  .ventas-table td:nth-child(1) {
    width: 22% !important;
    text-align: left !important;
    padding-left: 1mm !important;
  }
  
  .ventas-table th:nth-child(2),
  .ventas-table td:nth-child(2) {
    width: 8% !important;
  }
  
  .ventas-table th:nth-child(3),
  .ventas-table td:nth-child(3),
  .ventas-table th:nth-child(4),
  .ventas-table td:nth-child(4),
  .ventas-table th:nth-child(5),
  .ventas-table td:nth-child(5) {
    width: 19% !important;
    text-align: right !important;
    padding-right: 1mm !important;
  }
  
  .ventas-table th:nth-child(6),
  .ventas-table td:nth-child(6) {
    width: 10% !important;
  }
  
  /* Totales ultra compactos */
  .totales-print {
    width: 100% !important;
    background: #f0f0f0 !important;
    border: 1pt solid #a30015 !important;
    padding: 1mm !important;
    margin: 1mm 0 0 0 !important;
    font-size: 6.5pt !important;
    font-weight: bold !important;
    page-break-inside: avoid !important;
    display: table !important;
    border-collapse: collapse !important;
  }
  
  .totales-grid {
    display: table-row !important;
  }
  
  .totales-grid > div {
    display: table-cell !important;
    padding: 1mm !important;
    text-align: center !important;
    border: 1px solid #a30015 !important;
  }
  
  /* Salto de página cada 15 filas en landscape con tabla compacta */
  /* Intentar evitar cortes abruptos: solo forzar salto antes de filas largas */
  .ventas-table tbody tr {page-break-inside: avoid !important;}
  /* Si se desea un salto periódico, comentar la línea anterior y activar siguiente regla */
  /* .ventas-table tbody tr:nth-child(18n) { page-break-after: always; } */
}